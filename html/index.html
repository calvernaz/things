<!DOCTYPE html>
<!-- include aframe -->
<script src="https://aframe.io/releases/0.6.0/aframe.min.js"></script>
<!-- include aframe-artoolkit -->
<script src="aframe-ar.js"></script>
<script>
	const regex_temp = /[^TEMP0]+$/g;
	const regex_batt = /[^BATT0]+$/g;

	let source = new EventSource('/events/', { withCredentials: true });
	source.addEventListener('temp', (e) => {
		let textEl = document.querySelector('a-text');
		let d = JSON.parse(e.data);
		switch (d) {
			case /TEMP/.test(d.data[0]):
			    textEl.setAttribute('value', regex_temp.exec(d.data[0])[0]);
			case /BATT/.test(d.data[0]):
                textEl.setAttribute('value', regex_batt.exec(d.data[0])[0]);
        }
	});

</script>
<body style='margin : 0px; overflow: hidden; font-family: Monospace; '>
	<div style='position: fixed; top: 10px; width:inherit; text-align: center; z-index: 1;'></div>
	<a-scene embedded artoolkit='sourceType: webcam;'>
		<a-marker type='pattern' url='markers/hiro.patt' size='1'>
			<a-entity>
				<a-text value="No Value"></a-text>
			</a-entity>
		</a-marker>
		<a-marker-camera preset="hiro"></a-marker-camera>
		<a-entity camera></a-entity>
	</a-scene>
</body>
</html>
